@{
    ViewData["Title"] = "Quản lý Đảng viên";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="bi bi-people-fill text-primary me-2"></i>
                        Quản lý Đảng viên
                    </h3>
                    <p class="text-muted mb-0">Danh sách đảng viên từ nhân viên và học viên</p>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="dangVienTable" class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Loại</th>
                                    <th>Họ tên</th>
                                    <th>Ngày sinh</th>
                                    <th>Cấp bậc</th>
                                    <th>Chức vụ</th>
                                    <th>Loại đảng viên</th>
                                    <th>Trình độ</th>
                                    <th>Ngày vào đảng chính thức</th>
                                    <th>Ngày vào đảng dự bị</th>
                                    <th>Khen thưởng</th>
                                    <th>Kỷ luật</th>
                                    <th>Kết quả học tập</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
}

@section Scripts {
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#dangVienTable').DataTable({
                ajax: {
                    url: '@Url.Action("GetData", "DangVien")',
                    type: 'GET',
                    dataSrc: 'data'
                },
                columns: [
                    { 
                        data: 'Loai',
                        render: function(data) {
                            if (data === 'Nhân viên') {
                                return '<span class="badge bg-primary">' + data + '</span>';
                            } else {
                                return '<span class="badge bg-success">' + data + '</span>';
                            }
                        }
                    },
                    { data: 'HoTen' },
                    { data: 'NgaySinh' },
                    { data: 'CapBac' },
                    { data: 'ChucVu' },
                    { data: 'LoaiDangVien' },
                    { data: 'TrinhDo' },
                    { data: 'NgayVaoDangChinhThuc' },
                    { data: 'NgayVaoDangDuBi' },
                    { 
                        data: 'KhenThuong',
                        render: function(data) {
                            if (data > 0) {
                                return '<span class="badge bg-success">' + data + '</span>';
                            }
                            return '<span class="text-muted">0</span>';
                        }
                    },
                    { 
                        data: 'KyLuat',
                        render: function(data) {
                            if (data > 0) {
                                return '<span class="badge bg-danger">' + data + '</span>';
                            }
                            return '<span class="text-muted">0</span>';
                        }
                    },
                    { 
                        data: 'KetQuaHocTap',
                        render: function(data) {
                            if (data > 0) {
                                return '<span class="badge bg-info">' + data + '</span>';
                            }
                            return '<span class="text-muted">0</span>';
                        }
                    }
                ],
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/vi.json'
                },
                pageLength: 25,
                responsive: true,
                order: [[1, 'asc']],
                columnDefs: [
                    {
                        targets: [0, 9, 10, 11],
                        orderable: false
                    }
                ]
            });
        });
    </script>
}
