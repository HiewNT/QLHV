using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using QLHV.Models;

namespace QLHV.Controllers;

public class KhenThuongController : Controller
{
    private readonly QlhvContext _context;

    public KhenThuongController(QlhvContext context)
    {
        _context = context;
    }

    // GET: KhenThuong
    public IActionResult Index()
    {
        return View();
    }

    // GET: KhenThuong/GetData - For DataTables AJAX
    public async Task<IActionResult> GetData()
    {
        var khenThuongs = await _context.KhenThuongs
            .Include(k => k.MaNhanVienNavigation)
            .Select(k => new
            {
                MaKhenThuong = k.MaKhenThuong,
                HoTen = k.MaNhanVienNavigation != null ? k.MaNhanVienNavigation.HoTen : "",
                LyDo = k.LyDo,
                NgayKhenThuong = k.NgayKhenThuong.HasValue ? k.NgayKhenThuong.Value.ToString("dd/MM/yyyy") : "",
                CapKhenThuong = k.CapKhenThuong
            })
            .ToListAsync();

        return Json(new { data = khenThuongs });
    }
}
